<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#0078E7"><meta name="author" content="åŒ…å­å›"><meta name="copyright" content="åŒ…å­å›"><meta name="generator" content="Hexo 5.2.0"><meta name="theme" content="hexo-theme-yun"><title>JUCå¹¶å‘å­¦ä¹ ç¬”è®° | åŒ…å­å›çš„å°ç«™</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/star-markdown-css@0.1.22/dist/yun/yun-markdown.min.css"><script src="//at.alicdn.com/t/font_1140697_ed8vp4atwoj.js" async></script><script src="https://cdn.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>document.addEventListener("DOMContentLoaded", () => {
  [".post-card",".post-content img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
});
</script><link id="light-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.20.0/themes/prism-tomorrow.css" media="(prefers-color-scheme: light)"><link id="dark-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.20.0/themes/prism-tomorrow.css" media="(prefers-color-scheme: dark)"><link rel="shortcut icon" type="image/svg+xml" href="/favicon.ico"><link rel="mask-icon" href="/favicon.ico" color="#0078E7"><link rel="alternate icon" href="/yun.ico"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="preload" href="/js/utils.js" as="script"><link rel="preload" href="/js/hexo-theme-yun.js" as="script"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script id="yun-config">
    const Yun = window.Yun || {};
    window.CONFIG = {"hostname":"sfafreshman.github.io","root":"/","title":"åŒ…å­å›çš„å°ç«™","version":"1.2.0","mode":"dark","copycode":true,"anonymous_image":"https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/avatar/none.jpg","say":{"api":"https://v1.hitokoto.cn","hitokoto":true},"fireworks":{"colors":["102, 167, 221","62, 131, 225","33, 78, 194"]}};
  </script><meta name="description" content="JUC   é‡‡ç”¨æºç +æ–‡æ¡£æ–¹å¼å­¦ä¹   ä»€ä¹ˆæ˜¯JUC   java.utilå·¥å…·åŒ…     å¹¶å‘:å¤šçº¿ç¨‹æ“ä½œæ“ä½œä¸€ä¸ªèµ„æº   cpuä¸€æ ¸,æ¨¡æ‹Ÿå¤šæ¡çº¿ç¨‹   å¹¶è¡Œ:å¤šä¸ªäººä¸€èµ·èµ°   CPUå¤šæ ¸,å¤šä¸ªçº¿ç¨‹åŒæ—¶è¿è¡Œ   Waitå’Œsleep1ã€æ¥è‡ªä¸åŒçš„ç±»wait -&gt;Object  sleep -&gt; Thread2ã€å…³äºé”çš„é‡Šæ”¾waitä¼šé‡Šæ”¾é”ï¼Œsleepç¡è§‰äº†ï¼ŒæŠ±ç€é”ç¡è§‰ï¼Œä¸ä¼šé‡Šæ”¾ 3ã€ä½¿">
<meta property="og:type" content="article">
<meta property="og:title" content="JUCå¹¶å‘å­¦ä¹ ç¬”è®°">
<meta property="og:url" content="https://sfafreshman.github.io/2021/04/08/JUC%E5%AD%A6%E4%B9%A0/index.html">
<meta property="og:site_name" content="åŒ…å­å›çš„å°ç«™">
<meta property="og:description" content="JUC   é‡‡ç”¨æºç +æ–‡æ¡£æ–¹å¼å­¦ä¹   ä»€ä¹ˆæ˜¯JUC   java.utilå·¥å…·åŒ…     å¹¶å‘:å¤šçº¿ç¨‹æ“ä½œæ“ä½œä¸€ä¸ªèµ„æº   cpuä¸€æ ¸,æ¨¡æ‹Ÿå¤šæ¡çº¿ç¨‹   å¹¶è¡Œ:å¤šä¸ªäººä¸€èµ·èµ°   CPUå¤šæ ¸,å¤šä¸ªçº¿ç¨‹åŒæ—¶è¿è¡Œ   Waitå’Œsleep1ã€æ¥è‡ªä¸åŒçš„ç±»wait -&gt;Object  sleep -&gt; Thread2ã€å…³äºé”çš„é‡Šæ”¾waitä¼šé‡Šæ”¾é”ï¼Œsleepç¡è§‰äº†ï¼ŒæŠ±ç€é”ç¡è§‰ï¼Œä¸ä¼šé‡Šæ”¾ 3ã€ä½¿">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://sheepnote.oss-cn-shenzhen.aliyuncs.com/20201006/20210322170332.png">
<meta property="og:image" content="https://sheepnote.oss-cn-shenzhen.aliyuncs.com/20201006/20210330212342.png">
<meta property="og:image" content="https://sheepnote.oss-cn-shenzhen.aliyuncs.com/20201006/20210330212403.png">
<meta property="og:image" content="https://sheepnote.oss-cn-shenzhen.aliyuncs.com/20201006/20210330212424.png">
<meta property="og:image" content="https://sheepnote.oss-cn-shenzhen.aliyuncs.com/20201006/20210330214037.png">
<meta property="og:image" content="https://sheepnote.oss-cn-shenzhen.aliyuncs.com/20201006/20210323151912.png">
<meta property="og:image" content="https://sheepnote.oss-cn-shenzhen.aliyuncs.com/20201006/20210323151944.png">
<meta property="og:image" content="https://sfafreshman.github.io/2021/04/08/JUC%E5%AD%A6%E4%B9%A0/JUC_md_files/01_20210325150248.png?v=1&type=image&token=V1:8HEaAjBtXmTIvprHJ7YSw1om8WE1nF9vrzOwwCSIJw8">
<meta property="og:image" content="https://sfafreshman.github.io/2021/04/08/JUC%E5%AD%A6%E4%B9%A0/JUC_md_files/02_20210325150257.png?v=1&type=image&token=V1:bQD8d945Z777r5xwEbmNVNoJMKc3tqpOOogHR_5od-o">
<meta property="og:image" content="https://sfafreshman.github.io/2021/04/08/JUC%E5%AD%A6%E4%B9%A0/JUC_md_files/03_20210325150330.png?v=1&type=image&token=V1:gpwseHVrgAL5RKm_0c2-yMuJRc7vJccqH1R98cDNaJI">
<meta property="og:image" content="https://sfafreshman.github.io/2021/04/08/JUC%E5%AD%A6%E4%B9%A0/JUC_md_files/04_20210325150340.png?v=1&type=image&token=V1:5RHrJAF1fsp4VFh1zIjp-PdUB-pnFfZT3ERcqZyW67o">
<meta property="og:image" content="https://sfafreshman.github.io/2021/04/08/JUC%E5%AD%A6%E4%B9%A0/JUC_md_files/05_20210325150348.png?v=1&type=image&token=V1:_D7GTafOz3trfRN0aCyOy8aIRv7BxYY_LGwzyCRbBvg">
<meta property="og:image" content="https://sfafreshman.github.io/2021/04/08/JUC%E5%AD%A6%E4%B9%A0/JUC_md_files/06_20210325150356.png?v=1&type=image&token=V1:fSWbriyf80g3GqY-bUR_Q0Y4HwtfV47WVTE7p3mOeZE">
<meta property="og:image" content="https://sfafreshman.github.io/2021/04/08/JUC%E5%AD%A6%E4%B9%A0/JUC_md_files/07_20210325150407.png?v=1&type=image&token=V1:fsWIsw_fCC9UkhX28Fyu8PmYv5VbujnnyJ0oiWCw8t8">
<meta property="og:image" content="https://sfafreshman.github.io/2021/04/08/JUC%E5%AD%A6%E4%B9%A0/JUC_md_files/08_20210325150417.png?v=1&type=image&token=V1:kGqW0DrYgT4PF3gTUbg-Etl2WipuUsC4JyEdKrzKpcA">
<meta property="og:image" content="https://sfafreshman.github.io/2021/04/08/JUC%E5%AD%A6%E4%B9%A0/JUC_md_files/09_20210325150425.png?v=1&type=image&token=V1:T_9z9K9Wj3sZr8xQ_Fg4818LkU6NDn46NWbXDRK0e6E">
<meta property="og:image" content="https://sfafreshman.github.io/2021/04/08/JUC%E5%AD%A6%E4%B9%A0/JUC_md_files/10_20210325150435.png?v=1&type=image&token=V1:sYs64Wqv1V6-Hw2pZHVXftibLBH_yytdeCr_8eoHuQE">
<meta property="og:image" content="https://sfafreshman.github.io/2021/04/08/JUC%E5%AD%A6%E4%B9%A0/JUC_md_files/10_20210325150444.png?v=1&type=image&token=V1:elZuMttx19IJGRFHxB_PhFoAe5Iv-LQbgnHlWkuFrW8">
<meta property="og:image" content="https://sfafreshman.github.io/2021/04/08/JUC%E5%AD%A6%E4%B9%A0/JUC_md_files/11_20210325150506.png?v=1&type=image&token=V1:lqJVF59Kpo5GeUeAzeowYSQoUe7DyB3zSN3oTUTzsY0">
<meta property="og:image" content="https://sfafreshman.github.io/2021/04/08/JUC%E5%AD%A6%E4%B9%A0/JUC_md_files/12_20210325150515.png?v=1&type=image&token=V1:YLvkwlFgsseRDarnJc4ZODiQx6bfCpb2nRv_iRcNBKg">
<meta property="og:image" content="https://sfafreshman.github.io/2021/04/08/JUC%E5%AD%A6%E4%B9%A0/JUC_md_files/13_20210325150524.png?v=1&type=image&token=V1:mC0S6cOo7mRCKvY5fd0Npgc-ZJLCHA59psB2L_wTZqw">
<meta property="og:image" content="https://sfafreshman.github.io/2021/04/08/JUC%E5%AD%A6%E4%B9%A0/JUC_md_files/14_20210325150533.png?v=1&type=image&token=V1:-1DXkutrjaCNDNOix5P-jmVi6fAq5Au-n1VUDqZG5Os">
<meta property="og:image" content="https://sfafreshman.github.io/2021/04/08/JUC%E5%AD%A6%E4%B9%A0/JUC_md_files/15_20210325150542.png?v=1&type=image&token=V1:E_ZzLxZoW0PoD9y4DVHajyuBVArL9jnC6FTN5ohMo6U">
<meta property="og:image" content="https://sfafreshman.github.io/2021/04/08/JUC%E5%AD%A6%E4%B9%A0/JUC_md_files/16_20210325150550.png?v=1&type=image&token=V1:wUq3fM9Dfr_AS0C0hUx5yEea7eZQPxuRI2wuKj8S5F4">
<meta property="og:image" content="https://sfafreshman.github.io/2021/04/08/JUC%E5%AD%A6%E4%B9%A0/JUC_md_files/17_20210325150600.png?v=1&type=image&token=V1:dySM0LHdejxhlv_UmEpBeGjfOlJkfyDCq66YmftZDQw">
<meta property="og:image" content="https://sfafreshman.github.io/2021/04/08/JUC%E5%AD%A6%E4%B9%A0/JUC_md_files/18_20210325150608.png?v=1&type=image&token=V1:fjetujmUR3gP1peHXiX86gdo6yyAg4yJDhpKGwwkmxM">
<meta property="og:image" content="https://sfafreshman.github.io/2021/04/08/JUC%E5%AD%A6%E4%B9%A0/JUC_md_files/19_20210325150616.png?v=1&type=image&token=V1:Y9cQig7yytkhQ_HCIHOCCM_vG2FPj1RUrOewccb3x64">
<meta property="og:image" content="https://sfafreshman.github.io/2021/04/08/JUC%E5%AD%A6%E4%B9%A0/JUC_md_files/19_20210325150622.png?v=1&type=image&token=V1:HtYkcgipjqRojL2wYf0eA0M-MJz76etv2VS3it-dHq4">
<meta property="og:image" content="https://sfafreshman.github.io/2021/04/08/JUC%E5%AD%A6%E4%B9%A0/JUC_md_files/20_20210325150628.png?v=1&type=image&token=V1:YrgACay29Q1Gam8Z0wSg9eohoIZA2OrDZdK85QU2hOA">
<meta property="og:image" content="https://sfafreshman.github.io/2021/04/08/JUC%E5%AD%A6%E4%B9%A0/JUC_md_files/21_20210325150635.png?v=1&type=image&token=V1:z0fZy0MQeHiVJ7yuCPlIkt35QPsKUXGphXEwwIjnNmY">
<meta property="og:image" content="https://sfafreshman.github.io/2021/04/08/JUC%E5%AD%A6%E4%B9%A0/JUC_md_files/22_20210325150641.png?v=1&type=image&token=V1:sANnjjRAGW1D6jVWxukwxyJpntA18_qQUGEqZ01Qe2U">
<meta property="og:image" content="https://sfafreshman.github.io/2021/04/08/JUC%E5%AD%A6%E4%B9%A0/JUC_md_files/23_20210325150647.png?v=1&type=image&token=V1:SUi-uwu7yPzW_YxlgfoBmAuCpWlE3MFMDxWbA9g8dtw">
<meta property="og:image" content="https://sheepnote.oss-cn-shenzhen.aliyuncs.com/20201006/20210323154333.png">
<meta property="og:image" content="https://sheepnote.oss-cn-shenzhen.aliyuncs.com/20201006/20210323160253.png">
<meta property="og:image" content="https://sheepnote.oss-cn-shenzhen.aliyuncs.com/20201006/20210323160508.png">
<meta property="og:image" content="https://sheepnote.oss-cn-shenzhen.aliyuncs.com/20201006/20210323160621.png">
<meta property="og:image" content="https://sheepnote.oss-cn-shenzhen.aliyuncs.com/20201006/20210323160733.png">
<meta property="og:image" content="https://sheepnote.oss-cn-shenzhen.aliyuncs.com/20201006/20210324210652.png">
<meta property="og:image" content="https://sheepnote.oss-cn-shenzhen.aliyuncs.com/20201006/20210324211031.png">
<meta property="og:image" content="https://sheepnote.oss-cn-shenzhen.aliyuncs.com/20201006/20210324211618.png">
<meta property="og:image" content="https://sheepnote.oss-cn-shenzhen.aliyuncs.com/20201006/20210324211142.png">
<meta property="og:image" content="https://sheepnote.oss-cn-shenzhen.aliyuncs.com/20201006/20210324211902.png">
<meta property="og:image" content="https://sheepnote.oss-cn-shenzhen.aliyuncs.com/20201006/20210324211944.png">
<meta property="og:image" content="https://sheepnote.oss-cn-shenzhen.aliyuncs.com/20201006/20210324213529.png">
<meta property="og:image" content="https://sheepnote.oss-cn-shenzhen.aliyuncs.com/20201006/20210324213831.png">
<meta property="og:image" content="https://sheepnote.oss-cn-shenzhen.aliyuncs.com/20201006/20210324214022.png">
<meta property="og:image" content="https://sheepnote.oss-cn-shenzhen.aliyuncs.com/20201006/20210324214145.png">
<meta property="og:image" content="c:/Users/Lenovo/AppData/Roaming/Typora/typora-user-images/image-20210324220212708.png">
<meta property="og:image" content="c:/Users/Lenovo/AppData/Roaming/Typora/typora-user-images/image-20210324220422410.png">
<meta property="og:image" content="c:/Users/Lenovo/AppData/Roaming/Typora/typora-user-images/image-20210324220914187.png">
<meta property="article:published_time" content="2021-04-08T20:19:08.000Z">
<meta property="article:modified_time" content="2021-04-29T17:37:28.845Z">
<meta property="article:author" content="åŒ…å­å›">
<meta property="article:tag" content="java">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://sheepnote.oss-cn-shenzhen.aliyuncs.com/20201006/20210322170332.png"><script src="/js/ui/mode.js"></script></head><body><script defer src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script defer src="/js/ui/fireworks.js"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="æ–‡ç« ç›®å½•"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-list-ordered"></use></svg></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="ç«™ç‚¹æ¦‚è§ˆ"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-passport-line"></use></svg></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="åŒ…å­å›"><img width="96" loading="lazy" src="/images/logo.png" alt="åŒ…å­å›"><span class="site-author-status" title="ä¸æƒ³ä¸Šå­¦">ğŸ˜­</span></a><div class="site-author-name"><a href="/about/">åŒ…å­å›</a></div><a class="site-name" href="/about/site.html">åŒ…å­å›çš„å°ç«™</a><sub class="site-subtitle"></sub><div class="site-desciption"></div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="é¦–é¡µ"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-home-4-line"></use></svg></span></a><div class="site-state-item"><a href="/archives/" title="å½’æ¡£"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-archive-line"></use></svg></span><span class="site-state-item-count">13</span></a></div><div class="site-state-item"><a href="/categories/" title="åˆ†ç±»"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-2-line"></use></svg></span><span class="site-state-item-count">7</span></a></div><div class="site-state-item"><a href="/tags/" title="æ ‡ç­¾"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="site-state-item-count">13</span></a></div><a class="site-state-item hty-icon-button" href="https://sfafreshman.github.io/categories/%E5%88%86%E4%BA%AB/" title="æ‹œè¯»"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-settings-line"></use></svg></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="mailto:sfa_freshman@qq.com" title="E-Mail" target="_blank" style="color:#8E71C1"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-mail-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="/images/qrcode.jpg" title="å¾®ä¿¡" target="_blank" style="color:#1AAD19"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-wechat-2-line"></use></svg></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="æˆ‘çš„å°ä¼™ä¼´ä»¬" style="color:dodgerblue"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-genderless-line"></use></svg></a></div></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#Wait%E5%92%8Csleep"><span class="toc-number">1.</span> <span class="toc-text">Waitå’Œsleep</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%94%81"><span class="toc-number">2.</span> <span class="toc-text">é”</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BC%A0%E7%BB%9F-Synchronized%E9%94%81"><span class="toc-number">2.1.</span> <span class="toc-text">ä¼ ç»Ÿ Synchronizedé”</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Lock%E9%94%81"><span class="toc-number">2.2.</span> <span class="toc-text">Locké”</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%9F%E4%BA%A7%E8%80%85%E5%92%8C%E6%B6%88%E8%B4%B9%E8%80%85%E9%97%AE%E9%A2%98"><span class="toc-number">3.</span> <span class="toc-text">ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…é—®é¢˜</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#lock%E5%AE%9E%E7%8E%B0"><span class="toc-number">3.1.</span> <span class="toc-text">lockå®ç°</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8%E9%94%81%E9%97%AE%E9%A2%98"><span class="toc-number">4.</span> <span class="toc-text">8é”é—®é¢˜</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Callable"><span class="toc-number">5.</span> <span class="toc-text">Callable</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E7%9A%84%E8%BE%85%E5%8A%A9%E7%B1%BB-%E5%BF%85%E4%BC%9A"><span class="toc-number">6.</span> <span class="toc-text">å¸¸ç”¨çš„è¾…åŠ©ç±»(å¿…ä¼š)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#CountDownLatch"><span class="toc-number">6.1.</span> <span class="toc-text">CountDownLatch</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CyclicBarrier"><span class="toc-number">6.2.</span> <span class="toc-text">CyclicBarrier</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Semaphore"><span class="toc-number">6.3.</span> <span class="toc-text">Semaphore</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%BB%E5%86%99%E9%94%81"><span class="toc-number">7.</span> <span class="toc-text">è¯»å†™é”</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%98%BB%E5%A1%9E%E9%98%9F%E5%88%97"><span class="toc-number">8.</span> <span class="toc-text">é˜»å¡é˜Ÿåˆ—</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BA%BF%E7%A8%8B%E6%B1%A0-%E9%87%8D%E7%82%B9"><span class="toc-number">9.</span> <span class="toc-text">çº¿ç¨‹æ± (é‡ç‚¹)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-%E5%9B%9B%E5%A4%A7%E5%87%BD%E6%95%B0%E5%BC%8F%E6%8E%A5%E5%8F%A3"><span class="toc-number">10.</span> <span class="toc-text">12:å››å¤§å‡½æ•°å¼æ¥å£</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Stream%E6%B5%81%E5%BC%8F%E8%AE%A1%E7%AE%97"><span class="toc-number">11.</span> <span class="toc-text">Streamæµå¼è®¡ç®—</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14-ForkJoin"><span class="toc-number">12.</span> <span class="toc-text">14:ForkJoin</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#15-%E5%BC%82%E6%AD%A5%E5%9B%9E%E8%B0%83"><span class="toc-number">13.</span> <span class="toc-text">15:å¼‚æ­¥å›è°ƒ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#16-JMM"><span class="toc-number">14.</span> <span class="toc-text">16:JMM</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#17-Volatile%E5%8F%AF%E8%A7%81%E6%80%A7%E5%8F%8A%E5%85%B6%E9%9D%9E%E5%8E%9F%E5%AD%90%E6%80%A7%E9%AA%8C%E8%AF%81"><span class="toc-number">15.</span> <span class="toc-text">17:Volatileå¯è§æ€§åŠå…¶éåŸå­æ€§éªŒè¯</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%8E%9F%E5%AD%90%E7%B1%BB%E8%A7%A3%E5%86%B3%E5%8E%9F%E5%AD%90%E6%80%A7%E9%97%AE%E9%A2%98"><span class="toc-number">15.1.</span> <span class="toc-text">ä½¿ç”¨åŸå­ç±»è§£å†³åŸå­æ€§é—®é¢˜</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%87%E4%BB%A4%E9%87%8D%E6%8E%92"><span class="toc-number">16.</span> <span class="toc-text">æŒ‡ä»¤é‡æ’</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DCL%E6%87%92%E6%B1%89%E5%BC%8F%E5%B0%B1%E4%BD%BF%E7%94%A8%E4%BA%86volatile"><span class="toc-number">17.</span> <span class="toc-text">DCLæ‡’æ±‰å¼å°±ä½¿ç”¨äº†volatile</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%9A%E4%B8%BE"><span class="toc-number">18.</span> <span class="toc-text">æšä¸¾:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CAS"><span class="toc-number">19.</span> <span class="toc-text">CAS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ABA%E9%97%AE%E9%A2%98"><span class="toc-number">20.</span> <span class="toc-text">ABAé—®é¢˜</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E5%AD%90%E5%BC%95%E7%94%A8"><span class="toc-number">21.</span> <span class="toc-text">åŸå­å¼•ç”¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AD%A4%E5%A4%84%E9%9C%80%E8%A6%81%E6%95%B2%E4%BB%A3%E7%A0%81-%E8%BF%98%E6%9C%89%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F%E8%BF%99%E4%BA%9B"><span class="toc-number">22.</span> <span class="toc-text">æ­¤å¤„éœ€è¦æ•²ä»£ç ,è¿˜æœ‰å•ä¾‹æ¨¡å¼è¿™äº›</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#21-%E5%AF%B9%E5%90%84%E7%A7%8D%E9%94%81%E7%9A%84%E7%90%86%E8%A7%A3"><span class="toc-number">23.</span> <span class="toc-text">21:å¯¹å„ç§é”çš„ç†è§£</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%AC%E5%B9%B3%E9%94%81-%E9%9D%9E%E5%85%AC%E5%B9%B3%E9%94%81"><span class="toc-number">23.1.</span> <span class="toc-text">å…¬å¹³é”,éå…¬å¹³é”</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%AF%E9%87%8D%E5%85%A5%E9%94%81-%E9%80%92%E5%BD%92%E9%94%81"><span class="toc-number">23.2.</span> <span class="toc-text">å¯é‡å…¥é”&#x2F;é€’å½’é”</span></a></li></ol></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="post-block" itemscope itemtype="https://schema.org/Article"><link itemprop="mainEntityOfPage" href="https://sfafreshman.github.io/2021/04/08/JUC%E5%AD%A6%E4%B9%A0/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="åŒ…å­å›"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="åŒ…å­å›çš„å°ç«™"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">JUCå¹¶å‘å­¦ä¹ ç¬”è®°</h1><div class="post-meta"><div class="post-time" style="display:inline-block"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-line"></use></svg></span> <time title="åˆ›å»ºæ—¶é—´ï¼š2021-04-08 20:19:08" itemprop="dateCreated datePublished" datetime="2021-04-08T20:19:08+00:00">2021-04-08</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-2-line"></use></svg></span> <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-04-29 17:37:28" itemprop="dateModified" datetime="2021-04-29T17:37:28+00:00">2021-04-29</time></div><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-line"></use></svg></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category" href="/categories/%E7%AC%94%E8%AE%B0/" style="--text-color:dimgray" itemprop="url" rel="index"><span itemprop="text">ç¬”è®°</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag" href="/tags/java/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">java</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body" style="--smc-primary:#0078E7;"><p>JUC</p>
<blockquote>
<p> é‡‡ç”¨æºç +æ–‡æ¡£æ–¹å¼å­¦ä¹ </p>
</blockquote>
<p>ä»€ä¹ˆæ˜¯JUC</p>
<blockquote>
<p> java.utilå·¥å…·åŒ…</p>
</blockquote>
<p><img src="https://sheepnote.oss-cn-shenzhen.aliyuncs.com/20201006/20210322170332.png" alt="image-20210322170330290" loading="lazy"></p>
<blockquote>
<p> å¹¶å‘:å¤šçº¿ç¨‹æ“ä½œæ“ä½œä¸€ä¸ªèµ„æº</p>
</blockquote>
<ul>
<li><p>cpuä¸€æ ¸,æ¨¡æ‹Ÿå¤šæ¡çº¿ç¨‹</p>
<blockquote>
<p> å¹¶è¡Œ:å¤šä¸ªäººä¸€èµ·èµ°</p>
</blockquote>
</li>
<li><p>CPUå¤šæ ¸,å¤šä¸ªçº¿ç¨‹åŒæ—¶è¿è¡Œ</p>
</li>
</ul>
<h3 id="Waitå’Œsleep"><a href="#Waitå’Œsleep" class="headerlink" title="Waitå’Œsleep"></a>Waitå’Œsleep</h3><p>1ã€æ¥è‡ªä¸åŒçš„ç±»<br>wait -&gt;Object</p>
<p> sleep -&gt; Thread<br>2ã€å…³äºé”çš„é‡Šæ”¾<br>waitä¼šé‡Šæ”¾é”ï¼Œsleepç¡è§‰äº†ï¼ŒæŠ±ç€é”ç¡è§‰ï¼Œä¸ä¼šé‡Šæ”¾</p>
<p>3ã€ä½¿ç”¨çš„èŒƒå›½æ˜¯ä¸åŒçš„</p>
<ul>
<li><p><code>waitå¿…é¡»åœ¨åŒæ­¥ä»£ç å—ä¸­</code></p>
</li>
<li><p>sleepå¯ä»¥å†ä»»ä½•åœ°æ–¹ç¡</p>
</li>
</ul>
<p>4ã€æ˜¯å¦éœ€è¦æ•è·å¼‚å¸¸<br>Waitä¸éœ€è¦æ•è·å¼‚å¸¸</p>
<p>//ç°åœ¨ä¹Ÿéœ€è¦äº†</p>
<p>sleepå¿…é¡»è¦æ•è·å¼‚å¸¸?</p>
<h3 id="é”"><a href="#é”" class="headerlink" title="é”"></a>é”</h3><h4 id="ä¼ ç»Ÿ-Synchronizedé”"><a href="#ä¼ ç»Ÿ-Synchronizedé”" class="headerlink" title="ä¼ ç»Ÿ Synchronizedé”"></a>ä¼ ç»Ÿ Synchronizedé”</h4><blockquote>
<p>çº¿ç¨‹å°±æ˜¯ä¸€ä¸ªå•ç‹¬çš„èµ„æºç±»,æ²¡æœ‰ä»»ä½•é™„å±çš„æ“ä½œ</p>
<p>èµ„æºç±»OOP</p>
<p>å¤šçº¿ç¨‹æ“ä½œåŒä¸€ä¸ªèµ„æºç±»,æŠŠèµ„æºç±»ä¸¢å…¥çº¿ç¨‹</p>
</blockquote>
<pre class="language-java" data-language="java"><code class="language-java"><span class="token comment">// èµ„æºç±» OOP</span>
<span class="token keyword">class</span> <span class="token class-name">Ticket</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">// å±æ€§ã€æ–¹æ³•</span>
        <span class="token keyword">private</span> <span class="token keyword">int</span> number <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span>
        <span class="token comment">// å–ç¥¨çš„æ–¹å¼</span>
        <span class="token comment">// synchronized æœ¬è´¨: é˜Ÿåˆ—ï¼Œé”</span>
        <span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">sale</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>number<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"å–å‡ºäº†"</span><span class="token operator">+</span><span class="token punctuation">(</span>number<span class="token operator">-</span> <span class="token operator">-</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"ç¥¨,å‰©ä½™ï¼š"</span><span class="token operator">+</span>number<span class="token punctuation">)</span><span class="token punctuation">;</span>
        	<span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span></code></pre>

<pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>time<span class="token punctuation">.</span></span><span class="token class-name">OffsetDateTime</span><span class="token punctuation">;</span><span class="token class-name">Lock</span> æ¥å£
<span class="token comment">/**
* çœŸæ­£çš„å¤šçº¿ç¨‹å¼€å‘ï¼Œå…¬å¸ä¸­çš„å¼€å‘ï¼Œé™ä½è€¦åˆæ€§
* çº¿ç¨‹å°±æ˜¯ä¸€ä¸ªå•ç‹¬çš„èµ„æºç±»ï¼Œæ²¡æœ‰ä»»ä½•é™„å±çš„æ“ä½œï¼
* 1ã€ å±æ€§ã€æ–¹æ³•
*/</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SaleTicketDemo01</span> <span class="token punctuation">&#123;</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
<span class="token comment">// å¹¶å‘ï¼šå¤šçº¿ç¨‹æ“ä½œåŒä¸€ä¸ªèµ„æºç±», æŠŠèµ„æºç±»ä¸¢å…¥çº¿ç¨‹</span>
<span class="token class-name">Ticket</span> ticket <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Ticket</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// @FunctionalInterface å‡½æ•°å¼æ¥å£ï¼Œjdk1.8 lambdaè¡¨è¾¾å¼ (å‚æ•°)->&#123; ä»£ç  &#125;</span>
        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">40</span> <span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            	ticket<span class="token punctuation">.</span><span class="token function">sale</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token string">"A"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//åŒä¸Šåˆ›å»ºåç§°ä¸ºB,Cçš„çº¿ç¨‹å¹¶start</span>
    <span class="token comment">//--------------çœç•¥çš„å¦å¤–ä¸¤ä¸ªçº¿ç¨‹</span>
        <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token punctuation">&#125;</span></code></pre>

<h4 id="Locké”"><a href="#Locké”" class="headerlink" title="Locké”"></a>Locké”</h4><p><img src="https://sheepnote.oss-cn-shenzhen.aliyuncs.com/20201006/20210330212342.png" alt="image-20210330212342160" loading="lazy"></p>
<p><code>å®ç°ç±»</code></p>
<p><img src="https://sheepnote.oss-cn-shenzhen.aliyuncs.com/20201006/20210330212403.png" alt="image-20210330212403217" loading="lazy"></p>
<blockquote>
<p> é»˜è®¤ä¸ºéå…¬å¹³é”</p>
</blockquote>
<p><img src="https://sheepnote.oss-cn-shenzhen.aliyuncs.com/20201006/20210330212424.png" alt="image-20210330212423864" loading="lazy"></p>
<pre class="language-java" data-language="java"><code class="language-java"><span class="token comment">// Lockä¸‰éƒ¨æ›²</span>
<span class="token comment">// 1ã€ new ReentrantLock();</span>
<span class="token comment">// 2ã€ lock.lock(); // åŠ é”</span>
<span class="token comment">// 3ã€ finally=> lock.unlock(); // è§£é”</span>
<span class="token keyword">class</span> <span class="token class-name">Ticket2</span> <span class="token punctuation">&#123;</span>
<span class="token comment">// å±æ€§ã€æ–¹æ³•</span>
            <span class="token keyword">private</span> <span class="token keyword">int</span> number <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span>
            <span class="token class-name">Lock</span> lock <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ReentrantLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sale</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
                    lock<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// åŠ é”</span>
                    <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
                    <span class="token comment">// ä¸šåŠ¡ä»£ç </span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>number<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
                    	<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"å–å‡ºäº†"</span><span class="token operator">+</span><span class="token punctuation">(</span>number<span class="token operator">--</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"ç¥¨,å‰©ä½™ï¼š"</span><span class="token operator">+</span>number<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    	<span class="token punctuation">&#125;</span>
                    <span class="token punctuation">&#125;</span> 
                <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                   		 e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">&#125;</span> <span class="token keyword">finally</span> <span class="token punctuation">&#123;</span>
                  		  lock<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è§£é”</span>
              <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code></pre>

<ul>
<li>æ“ä½œä»£ç </li>
</ul>
<pre class="language-java" data-language="java"><code class="language-java"><span class="token comment">//å…¬å¹³é”ï¼šååˆ†ä¸å…¬å¹³ï¼šå¯ä»¥æ’é˜Ÿ ï¼ˆé»˜è®¤ï¼‰</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>locks<span class="token punctuation">.</span></span><span class="token class-name">ReentrantLock</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SaleTicketDemo02</span> <span class="token punctuation">&#123;</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
<span class="token comment">// å¹¶å‘ï¼šå¤šçº¿ç¨‹æ“ä½œåŒä¸€ä¸ªèµ„æºç±», æŠŠèµ„æºç±»ä¸¢å…¥çº¿ç¨‹</span>
        <span class="token class-name">Ticket2</span> ticket <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Ticket2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// @FunctionalInterface å‡½æ•°å¼æ¥å£ï¼Œjdk1.8 lambdaè¡¨è¾¾å¼ (å‚æ•°)->&#123; ä»£ç  &#125;</span>
        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">40</span> <span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
      		  ticket<span class="token punctuation">.</span><span class="token function">sale</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token string">"A"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">40</span> <span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
       		 ticket<span class="token punctuation">.</span><span class="token function">sale</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token string">"B"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">40</span> <span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
       		 ticket<span class="token punctuation">.</span><span class="token function">sale</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token string">"C"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span></code></pre>



<blockquote>
<blockquote>
<p>Synchronized å’Œ Lock åŒºåˆ«<br>1ã€Synchronized å†…ç½®çš„Javaå…³é”®å­—ï¼Œ Lock æ˜¯ä¸€ä¸ªJavaç±»<br>2ã€Synchronized æ— æ³•åˆ¤æ–­è·å–é”çš„çŠ¶æ€ï¼ŒLock å¯ä»¥åˆ¤æ–­æ˜¯å¦è·å–åˆ°äº†é”<br>3ã€Synchronized ä¼šè‡ªåŠ¨é‡Šæ”¾é”ï¼Œlock å¿…é¡»è¦æ‰‹åŠ¨é‡Šæ”¾é”ï¼å¦‚æœä¸é‡Šæ”¾é”ï¼Œæ­»é”<br>4ã€Synchronized çº¿ç¨‹ 1ï¼ˆè·å¾—é”ï¼Œé˜»å¡ï¼‰ã€çº¿ç¨‹2ï¼ˆç­‰å¾…ï¼Œå‚»å‚»çš„ç­‰ï¼‰ï¼›Locké”å°±ä¸ä¸€å®šä¼šç­‰å¾…ä¸‹<br>å»ï¼›å¯ä»¥è®¾ç½®ç­‰å¾…è¶…æ—¶?<br>5ã€Synchronized å¯é‡å…¥é”ï¼Œä¸å¯ä»¥ä¸­æ–­çš„ï¼Œéå…¬å¹³ï¼›Lock ï¼Œå¯é‡å…¥é”ï¼Œå¯ä»¥ åˆ¤æ–­é”ï¼Œéå…¬å¹³ï¼ˆå¯ä»¥<br>è‡ªå·±è®¾ç½®ï¼‰ï¼›<br>6ã€Synchronized é€‚åˆé”å°‘é‡çš„ä»£ç åŒæ­¥é—®é¢˜ï¼ŒLock é€‚åˆé”å¤§é‡çš„åŒæ­¥ä»£ç ï¼<br>é”æ˜¯ä»€ä¹ˆï¼Œå¦‚ä½•åˆ¤æ–­é”çš„æ˜¯è°ï¼<br>4ã€ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…é—®é¢˜<br>é¢è¯•çš„ï¼šå•ä¾‹æ¨¡å¼ã€æ’åºç®—æ³•ã€ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ã€æ­»é”</p>
</blockquote>
</blockquote>
<h3 id="ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…é—®é¢˜"><a href="#ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…é—®é¢˜" class="headerlink" title="ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…é—®é¢˜"></a>ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…é—®é¢˜</h3><p><code>åˆ¤æ–­è¦ä½¿ç”¨if,ä¸èƒ½ä½¿ç”¨while</code>:è§å¤šçº¿ç¨‹ç¬”è®°</p>
<h4 id="lockå®ç°"><a href="#lockå®ç°" class="headerlink" title="lockå®ç°"></a>lockå®ç°</h4><blockquote>
<p>å¹¶å‘èµ„æºç±»</p>
</blockquote>
<pre class="language-java" data-language="java"><code class="language-java"><span class="token comment">// åˆ¤æ–­ç­‰å¾…ï¼Œä¸šåŠ¡ï¼Œé€šçŸ¥</span>
<span class="token keyword">class</span> <span class="token class-name">Data2</span><span class="token punctuation">&#123;</span> <span class="token comment">// æ•°å­— èµ„æºç±»</span>
<span class="token keyword">private</span> <span class="token keyword">int</span> number <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token class-name">Lock</span> lock <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ReentrantLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Condition</span> condition <span class="token operator">=</span> lock<span class="token punctuation">.</span><span class="token function">newCondition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//condition.await(); // ç­‰å¾…</span>
<span class="token comment">//condition.signalAll(); // å”¤é†’å…¨éƒ¨</span>
<span class="token comment">//+1</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">&#123;</span>
        lock<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">// ä¸šåŠ¡ä»£ç </span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>number<span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token comment">//0</span>
        <span class="token comment">// ç­‰å¾…</span>
        condition<span class="token punctuation">.</span><span class="token function">await</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
	number<span class="token operator">++</span><span class="token punctuation">;</span>
	<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"=>"</span><span class="token operator">+</span>number<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// é€šçŸ¥å…¶ä»–çº¿ç¨‹ï¼Œæˆ‘+1å®Œæ¯•äº†</span>
	condition<span class="token punctuation">.</span><span class="token function">signalAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> 
    <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
	e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span> <span class="token keyword">finally</span> <span class="token punctuation">&#123;</span>
l	ock<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">//-1</span>
<span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">decrement</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">&#123;</span>
        lock<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
       		 <span class="token keyword">while</span> <span class="token punctuation">(</span>number<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token comment">// 1</span>
        <span class="token comment">// ç­‰å¾…</span>
       		 condition<span class="token punctuation">.</span><span class="token function">await</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        number<span class="token operator">--</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"=>"</span><span class="token operator">+</span>number<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// é€šçŸ¥å…¶ä»–çº¿ç¨‹ï¼Œæˆ‘-1å®Œæ¯•äº†</span>
        condition<span class="token punctuation">.</span><span class="token function">signalAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
       		 e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">finally</span> <span class="token punctuation">&#123;</span>
      		  lock<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code></pre>

<blockquote>
<p>å¹¶å‘è®¿é—®</p>
</blockquote>
<pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>kuang<span class="token punctuation">.</span>pc</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>locks<span class="token punctuation">.</span></span><span class="token class-name">Condition</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>locks<span class="token punctuation">.</span></span><span class="token class-name">Lock</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>locks<span class="token punctuation">.</span></span><span class="token class-name">ReentrantLock</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">B</span> <span class="token punctuation">&#123;</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token class-name">Data2</span> data <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Data2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
                    data<span class="token punctuation">.</span><span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token string">"A"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
           			 data<span class="token punctuation">.</span><span class="token function">decrement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
           		 e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
           	 <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token string">"B"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
           			 data<span class="token punctuation">.</span><span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            		e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token string">"C"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
            data<span class="token punctuation">.</span><span class="token function">decrement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token string">"D"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code></pre>

<p>ä»»ä½•ä¸€ä¸ªæ–°çš„æŠ€æœ¯ï¼Œç»å¯¹ä¸æ˜¯ä»…ä»…åªæ˜¯è¦†ç›–äº†åŸæ¥çš„æŠ€æœ¯ï¼Œä¼˜åŠ¿å’Œè¡¥å……ï¼</p>
<blockquote>
<p>Condition ç²¾å‡†çš„é€šçŸ¥å’Œå”¤é†’çº¿ç¨‹</p>
<p><code>condition1.await();</code></p>
<p><code>condition2.signal();</code></p>
</blockquote>
<pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">printA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
lock<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
<span class="token comment">// ä¸šåŠ¡ï¼Œåˆ¤æ–­-> æ‰§è¡Œ-> é€šçŸ¥</span>
<span class="token keyword">while</span> <span class="token punctuation">(</span>number<span class="token operator">!=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
<span class="token comment">// ç­‰å¾…</span>
condition1<span class="token punctuation">.</span><span class="token function">await</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"=>AAAAAAA"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// å”¤é†’ï¼Œå”¤é†’æŒ‡å®šçš„äººï¼ŒB</span>
number <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
condition2<span class="token punctuation">.</span><span class="token function">signal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> <span class="token keyword">finally</span> <span class="token punctuation">&#123;</span>
lock<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code></pre>

<h3 id="8é”é—®é¢˜"><a href="#8é”é—®é¢˜" class="headerlink" title="8é”é—®é¢˜"></a>8é”é—®é¢˜</h3><blockquote>
<p>å¦‚ä½•åˆ¤æ–­é”çš„æ˜¯è°ï¼æ°¸è¿œçš„çŸ¥é“ä»€ä¹ˆé”ï¼Œé”åˆ°åº•é”çš„æ˜¯è°ï¼</p>
</blockquote>
<h3 id="Callable"><a href="#Callable" class="headerlink" title="Callable"></a>Callable</h3><p>1ã€å¯ä»¥æœ‰è¿”å›å€¼ </p>
<p>2ã€å¯ä»¥æŠ›å‡ºå¼‚å¸¸ </p>
<p>3ã€æ–¹æ³•ä¸åŒï¼Œrun()/ call()</p>
<pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"call()"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ä¼šæ‰“å°å‡ ä¸ªcall</span>
<span class="token comment">// è€—æ—¶çš„æ“ä½œ</span>
<span class="token keyword">return</span> <span class="token number">1024</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code></pre>



<pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CallableTest</span> <span class="token punctuation">&#123;</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ExecutionException</span><span class="token punctuation">,</span>
<span class="token class-name">InterruptedException</span> <span class="token punctuation">&#123;</span>
<span class="token comment">// new Thread(new Runnable()).start();</span>
<span class="token comment">// new Thread(new FutureTask&lt;V>()).start();</span>
<span class="token comment">// new Thread(new FutureTask&lt;V>( Callable )).start();</span>
<span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ€ä¹ˆå¯åŠ¨Callable</span>
<span class="token class-name">MyThread</span> thread <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">FutureTask</span> futureTask <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FutureTask</span><span class="token punctuation">(</span>thread<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// é€‚é…ç±»</span>
<span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>futureTask<span class="token punctuation">,</span><span class="token string">"A"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>futureTask<span class="token punctuation">,</span><span class="token string">"B"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ç»“æœä¼šè¢«ç¼“å­˜ï¼Œæ•ˆç‡é«˜</span>
<span class="token class-name">Integer</span> o <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Integer</span><span class="token punctuation">)</span> futureTask<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//è¿™ä¸ªget æ–¹æ³•å¯èƒ½ä¼šäº§ç”Ÿé˜»å¡ï¼æŠŠä»–æ”¾åˆ°</span>
æœ€å
<span class="token comment">// æˆ–è€…ä½¿ç”¨å¼‚æ­¥é€šä¿¡æ¥å¤„ç†ï¼</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">class</span> <span class="token class-name">MyThread</span> <span class="token keyword">implements</span> <span class="token class-name">Callable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> <span class="token punctuation">&#123;</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"call()"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ä¼šæ‰“å°å‡ ä¸ªcall</span>
<span class="token comment">// è€—æ—¶çš„æ“ä½œ</span>
<span class="token keyword">return</span> <span class="token number">1024</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre>

<blockquote>
<p>1ã€æœ‰ç¼“å­˜ 2ã€ç»“æœå¯èƒ½éœ€è¦ç­‰å¾…ï¼Œä¼šé˜»å¡ï¼</p>
</blockquote>
<h3 id="å¸¸ç”¨çš„è¾…åŠ©ç±»-å¿…ä¼š"><a href="#å¸¸ç”¨çš„è¾…åŠ©ç±»-å¿…ä¼š" class="headerlink" title="å¸¸ç”¨çš„è¾…åŠ©ç±»(å¿…ä¼š)"></a>å¸¸ç”¨çš„è¾…åŠ©ç±»(å¿…ä¼š)</h3><h4 id="CountDownLatch"><a href="#CountDownLatch" class="headerlink" title="CountDownLatch"></a>CountDownLatch</h4><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CountDownLatchDemo</span> <span class="token punctuation">&#123;</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">&#123;</span>
<span class="token comment">// æ€»æ•°æ˜¯6ï¼Œå¿…é¡»è¦æ‰§è¡Œä»»åŠ¡çš„æ—¶å€™ï¼Œå†ä½¿ç”¨ï¼</span>
<span class="token class-name">CountDownLatch</span> countDownLatch <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CountDownLatch</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span><span class="token number">6</span> <span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
<span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">" Go out"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
countDownLatch<span class="token punctuation">.</span><span class="token function">countDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ•°é‡-1</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
countDownLatch<span class="token punctuation">.</span><span class="token function">await</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ç­‰å¾…è®¡æ•°å™¨å½’é›¶ï¼Œç„¶åå†å‘ä¸‹æ‰§è¡Œ</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Close Door"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code></pre>

<p><code>countDownLatch.countDown();</code> // æ•°é‡-1</p>
<p><code>countDownLatch.await();</code></p>
<p> // ç­‰å¾…è®¡æ•°å™¨å½’é›¶ï¼Œç„¶åå†å‘ä¸‹æ‰§è¡Œ æ¯æ¬¡æœ‰çº¿ç¨‹è°ƒç”¨ countDown() æ•°é‡-1ï¼Œå‡è®¾è®¡æ•°å™¨å˜ä¸º0ï¼ŒcountDownLatch.await() å°±ä¼šè¢«å”¤é†’ï¼Œç»§ç»­ æ‰§è¡Œï¼</p>
<h4 id="CyclicBarrier"><a href="#CyclicBarrier" class="headerlink" title="CyclicBarrier"></a>CyclicBarrier</h4><blockquote>
<blockquote>
<p>åŠ æ³•è®¡æ•°å™¨</p>
</blockquote>
</blockquote>
<h4 id="Semaphore"><a href="#Semaphore" class="headerlink" title="Semaphore"></a>Semaphore</h4><blockquote>
<p>  ä¿¡å·é‡</p>
<p> semaphore.acquire() è·å¾—ï¼Œå‡è®¾å¦‚æœå·²ç»æ»¡äº†ï¼Œç­‰å¾…ï¼Œç­‰å¾…è¢«é‡Šæ”¾ä¸ºæ­¢<br> semaphore.release(); é‡Šæ”¾ï¼Œä¼šå°†å½“å‰çš„ä¿¡å·é‡é‡Šæ”¾ + 1ï¼Œç„¶åå”¤é†’ç­‰å¾…çš„çº¿ç¨‹ï¼ ä½œç”¨ï¼š å¤šä¸ªå…±äº«èµ„æºäº’æ–¥çš„ä½¿ç”¨ï¼å¹¶å‘é™æµï¼Œæ§åˆ¶æœ€å¤§çš„çº¿ç¨‹æ•°ï¼</p>
</blockquote>
<pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SemaphoreDemo</span> <span class="token punctuation">&#123;</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
<span class="token comment">// çº¿ç¨‹æ•°é‡ï¼šåœè½¦ä½! é™æµï¼</span>
<span class="token class-name">Semaphore</span> semaphore <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Semaphore</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span><span class="token number">6</span> <span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
<span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span>
<span class="token comment">// acquire() å¾—åˆ°</span>
<span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
semaphore<span class="token punctuation">.</span><span class="token function">acquire</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span>"æŠ¢åˆ°è½¦
ä½"<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>SECONDS<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span>"ç¦»å¼€è½¦
ä½"<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> <span class="token keyword">finally</span> <span class="token punctuation">&#123;</span>
semaphore<span class="token punctuation">.</span><span class="token function">release</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// release() é‡Šæ”¾</span>
<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code></pre>

<h3 id="è¯»å†™é”"><a href="#è¯»å†™é”" class="headerlink" title="è¯»å†™é”"></a>è¯»å†™é”</h3><pre class="language-java" data-language="java"><code class="language-java"><span class="token comment">/**
* ç‹¬å é”ï¼ˆå†™é”ï¼‰ ä¸€æ¬¡åªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹å æœ‰
* å…±äº«é”ï¼ˆè¯»é”ï¼‰ å¤šä¸ªçº¿ç¨‹å¯ä»¥åŒæ—¶å æœ‰
* ReadWriteLock
* è¯»-è¯» å¯ä»¥å…±å­˜ï¼
* è¯»-å†™ ä¸èƒ½å…±å­˜ï¼
* å†™-å†™ ä¸èƒ½å…±å­˜ï¼
*/</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ReadWriteLockDemo</span> <span class="token punctuation">&#123;</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
<span class="token class-name">MyCache</span> myCache <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// å†™å…¥</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">5</span> <span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
<span class="token keyword">final</span> <span class="token keyword">int</span> temp <span class="token operator">=</span> i<span class="token punctuation">;</span>
<span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span>myCache<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>temp<span class="token operator">+</span><span class="token string">""</span><span class="token punctuation">,</span>temp<span class="token operator">+</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">// è¯»å–</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">5</span> <span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
<span class="token keyword">final</span> <span class="token keyword">int</span> temp <span class="token operator">=</span> i<span class="token punctuation">;</span>
<span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span>
myCache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>temp<span class="token operator">+</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">// åŠ é”çš„</span>
<span class="token keyword">class</span> <span class="token class-name">MyCacheLock</span><span class="token punctuation">&#123;</span>
<span class="token keyword">private</span> <span class="token keyword">volatile</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">Object</span><span class="token punctuation">></span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// è¯»å†™é”ï¼š æ›´åŠ ç»†ç²’åº¦çš„æ§åˆ¶</span>
<span class="token keyword">private</span> <span class="token class-name">ReadWriteLock</span> readWriteLock <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ReentrantReadWriteLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">private</span> <span class="token class-name">Lock</span> lock <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ReentrantLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// å­˜ï¼Œå†™å…¥çš„æ—¶å€™ï¼Œåªå¸Œæœ›åŒæ—¶åªæœ‰ä¸€ä¸ªçº¿ç¨‹å†™</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span><span class="token class-name">Object</span> value<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
readWriteLock<span class="token punctuation">.</span><span class="token function">writeLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"å†™å…¥"</span><span class="token operator">+</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"å†™å…¥OK"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> <span class="token keyword">finally</span> <span class="token punctuation">&#123;</span>
readWriteLock<span class="token punctuation">.</span><span class="token function">writeLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">// å–ï¼Œè¯»ï¼Œæ‰€æœ‰äººéƒ½å¯ä»¥è¯»ï¼</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
readWriteLock<span class="token punctuation">.</span><span class="token function">readLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"è¯»å–"</span><span class="token operator">+</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Object</span> o <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"è¯»å–OK"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> <span class="token keyword">finally</span> <span class="token punctuation">&#123;</span>
readWriteLock<span class="token punctuation">.</span><span class="token function">readLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">/**
* è‡ªå®šä¹‰ç¼“å­˜
*/</span>
<span class="token keyword">class</span> <span class="token class-name">MyCache</span><span class="token punctuation">&#123;</span>
<span class="token keyword">private</span> <span class="token keyword">volatile</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">Object</span><span class="token punctuation">></span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token number">10</span>ã€é˜»å¡é˜Ÿåˆ—
é˜»å¡é˜Ÿåˆ—ï¼š
<span class="token comment">// å­˜ï¼Œå†™</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span><span class="token class-name">Object</span> value<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"å†™å…¥"</span><span class="token operator">+</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"å†™å…¥OK"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">// å–ï¼Œè¯»</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"è¯»å–"</span><span class="token operator">+</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Object</span> o <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"è¯»å–OK"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code></pre>

<h3 id="é˜»å¡é˜Ÿåˆ—"><a href="#é˜»å¡é˜Ÿåˆ—" class="headerlink" title="é˜»å¡é˜Ÿåˆ—"></a>é˜»å¡é˜Ÿåˆ—</h3><p>ä»€ä¹ˆæƒ…å†µä¸‹æˆ‘ä»¬ä¼šä½¿ç”¨ é˜»å¡é˜Ÿåˆ—ï¼šå¤šçº¿ç¨‹å¹¶å‘å¤„ç†ï¼Œçº¿ç¨‹æ± ï¼ å­¦ä¼šä½¿ç”¨é˜Ÿåˆ— æ·»åŠ ã€ç§»é™¤ </p>
<p><img src="https://sheepnote.oss-cn-shenzhen.aliyuncs.com/20201006/20210330214037.png" alt="image-20210330214037634" loading="lazy"></p>
<h3 id="çº¿ç¨‹æ± -é‡ç‚¹"><a href="#çº¿ç¨‹æ± -é‡ç‚¹" class="headerlink" title="çº¿ç¨‹æ± (é‡ç‚¹)"></a>çº¿ç¨‹æ± (é‡ç‚¹)</h3><p><code>çº¿ç¨‹æ± ï¼šä¸‰å¤§æ–¹æ³•ã€7å¤§å‚æ•°ã€4ç§æ‹’ç»ç­–ç•¥</code></p>
<blockquote>
<blockquote>
<p><img src="https://sheepnote.oss-cn-shenzhen.aliyuncs.com/20201006/20210323151912.png" alt="image-20210323151912115" loading="lazy"></p>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p><img src="https://sheepnote.oss-cn-shenzhen.aliyuncs.com/20201006/20210323151944.png" alt="image-20210323151944753" loading="lazy"></p>
<p><img src="JUC_md_files/01_20210325150248.png?v=1&type=image&token=V1:8HEaAjBtXmTIvprHJ7YSw1om8WE1nF9vrzOwwCSIJw8" alt="è¾“å…¥å›¾ç‰‡æè¿°" loading="lazy"><br><img src="JUC_md_files/02_20210325150257.png?v=1&type=image&token=V1:bQD8d945Z777r5xwEbmNVNoJMKc3tqpOOogHR_5od-o" alt="è¾“å…¥å›¾ç‰‡æè¿°" loading="lazy"><br><img src="JUC_md_files/03_20210325150330.png?v=1&type=image&token=V1:gpwseHVrgAL5RKm_0c2-yMuJRc7vJccqH1R98cDNaJI" alt="è¾“å…¥å›¾ç‰‡æè¿°" loading="lazy"><br><img src="JUC_md_files/04_20210325150340.png?v=1&type=image&token=V1:5RHrJAF1fsp4VFh1zIjp-PdUB-pnFfZT3ERcqZyW67o" alt="è¾“å…¥å›¾ç‰‡æè¿°" loading="lazy"><br><img src="JUC_md_files/05_20210325150348.png?v=1&type=image&token=V1:_D7GTafOz3trfRN0aCyOy8aIRv7BxYY_LGwzyCRbBvg" alt="è¾“å…¥å›¾ç‰‡æè¿°" loading="lazy"><br><img src="JUC_md_files/06_20210325150356.png?v=1&type=image&token=V1:fSWbriyf80g3GqY-bUR_Q0Y4HwtfV47WVTE7p3mOeZE" alt="è¾“å…¥å›¾ç‰‡æè¿°" loading="lazy"><br><img src="JUC_md_files/07_20210325150407.png?v=1&type=image&token=V1:fsWIsw_fCC9UkhX28Fyu8PmYv5VbujnnyJ0oiWCw8t8" alt="è¾“å…¥å›¾ç‰‡æè¿°" loading="lazy"><br><img src="JUC_md_files/08_20210325150417.png?v=1&type=image&token=V1:kGqW0DrYgT4PF3gTUbg-Etl2WipuUsC4JyEdKrzKpcA" alt="è¾“å…¥å›¾ç‰‡æè¿°" loading="lazy"><br><img src="JUC_md_files/09_20210325150425.png?v=1&type=image&token=V1:T_9z9K9Wj3sZr8xQ_Fg4818LkU6NDn46NWbXDRK0e6E" alt="è¾“å…¥å›¾ç‰‡æè¿°" loading="lazy"><br><img src="JUC_md_files/10_20210325150435.png?v=1&type=image&token=V1:sYs64Wqv1V6-Hw2pZHVXftibLBH_yytdeCr_8eoHuQE" alt="è¾“å…¥å›¾ç‰‡æè¿°" loading="lazy"><br><img src="JUC_md_files/10_20210325150444.png?v=1&type=image&token=V1:elZuMttx19IJGRFHxB_PhFoAe5Iv-LQbgnHlWkuFrW8" alt="è¾“å…¥å›¾ç‰‡æè¿°" loading="lazy"><br><img src="JUC_md_files/11_20210325150506.png?v=1&type=image&token=V1:lqJVF59Kpo5GeUeAzeowYSQoUe7DyB3zSN3oTUTzsY0" alt="è¾“å…¥å›¾ç‰‡æè¿°" loading="lazy"><br><img src="JUC_md_files/12_20210325150515.png?v=1&type=image&token=V1:YLvkwlFgsseRDarnJc4ZODiQx6bfCpb2nRv_iRcNBKg" alt="è¾“å…¥å›¾ç‰‡æè¿°" loading="lazy"><img src="JUC_md_files/13_20210325150524.png?v=1&type=image&token=V1:mC0S6cOo7mRCKvY5fd0Npgc-ZJLCHA59psB2L_wTZqw" alt="è¾“å…¥å›¾ç‰‡æè¿°" loading="lazy"><img src="JUC_md_files/14_20210325150533.png?v=1&type=image&token=V1:-1DXkutrjaCNDNOix5P-jmVi6fAq5Au-n1VUDqZG5Os" alt="è¾“å…¥å›¾ç‰‡æè¿°" loading="lazy"><img src="JUC_md_files/15_20210325150542.png?v=1&type=image&token=V1:E_ZzLxZoW0PoD9y4DVHajyuBVArL9jnC6FTN5ohMo6U" alt="è¾“å…¥å›¾ç‰‡æè¿°" loading="lazy"><img src="JUC_md_files/16_20210325150550.png?v=1&type=image&token=V1:wUq3fM9Dfr_AS0C0hUx5yEea7eZQPxuRI2wuKj8S5F4" alt="è¾“å…¥å›¾ç‰‡æè¿°" loading="lazy"><img src="JUC_md_files/17_20210325150600.png?v=1&type=image&token=V1:dySM0LHdejxhlv_UmEpBeGjfOlJkfyDCq66YmftZDQw" alt="è¾“å…¥å›¾ç‰‡æè¿°" loading="lazy"><img src="JUC_md_files/18_20210325150608.png?v=1&type=image&token=V1:fjetujmUR3gP1peHXiX86gdo6yyAg4yJDhpKGwwkmxM" alt="è¾“å…¥å›¾ç‰‡æè¿°" loading="lazy"><img src="JUC_md_files/19_20210325150616.png?v=1&type=image&token=V1:Y9cQig7yytkhQ_HCIHOCCM_vG2FPj1RUrOewccb3x64" alt="è¾“å…¥å›¾ç‰‡æè¿°" loading="lazy"><img src="JUC_md_files/19_20210325150622.png?v=1&type=image&token=V1:HtYkcgipjqRojL2wYf0eA0M-MJz76etv2VS3it-dHq4" alt="è¾“å…¥å›¾ç‰‡æè¿°" loading="lazy"><img src="JUC_md_files/20_20210325150628.png?v=1&type=image&token=V1:YrgACay29Q1Gam8Z0wSg9eohoIZA2OrDZdK85QU2hOA" alt="è¾“å…¥å›¾ç‰‡æè¿°" loading="lazy"><img src="JUC_md_files/21_20210325150635.png?v=1&type=image&token=V1:z0fZy0MQeHiVJ7yuCPlIkt35QPsKUXGphXEwwIjnNmY" alt="è¾“å…¥å›¾ç‰‡æè¿°" loading="lazy"><img src="JUC_md_files/22_20210325150641.png?v=1&type=image&token=V1:sANnjjRAGW1D6jVWxukwxyJpntA18_qQUGEqZ01Qe2U" alt="è¾“å…¥å›¾ç‰‡æè¿°" loading="lazy"><img src="JUC_md_files/23_20210325150647.png?v=1&type=image&token=V1:SUi-uwu7yPzW_YxlgfoBmAuCpWlE3MFMDxWbA9g8dtw" alt="è¾“å…¥å›¾ç‰‡æè¿°" loading="lazy"></p>
</blockquote>
</blockquote>
<h3 id="12-å››å¤§å‡½æ•°å¼æ¥å£"><a href="#12-å››å¤§å‡½æ•°å¼æ¥å£" class="headerlink" title="12:å››å¤§å‡½æ•°å¼æ¥å£"></a>12:å››å¤§å‡½æ•°å¼æ¥å£</h3><p>lamdbaè¡¨è¾¾å¼,å‡½æ•°å¼æ¥å£,é“¾å¼ç¼–ç¨‹,Streamæµ</p>
<p><img src="https://sheepnote.oss-cn-shenzhen.aliyuncs.com/20201006/20210323154333.png" alt="image-20210323154333067" loading="lazy"></p>
<ul>
<li><p>Functionæ¥å£:å…¥å‚åˆ†åˆ«ä¸ºå‚æ•°ç±»å‹å’Œè¿”å›å€¼ç±»å‹</p>
</li>
<li><p>æ–­å®šå‹æ¥å£,ä¸€ä¸ªè¾“å…¥å‚æ•°,è¿”å›å€¼åªèƒ½æ˜¯å¸ƒå°”å€¼</p>
</li>
<li><p>æ¶ˆè´¹å‹æ¥å£,ç”Ÿäº§è€…æ¥å£</p>
</li>
<li><p>æ¶ˆè´¹å‹æ¥å£:åªæœ‰è¾“å…¥,æ²¡æœ‰è¿”å›å€¼</p>
</li>
<li><p>ç”Ÿäº§è€…æ¥å£,æ²¡æœ‰è¾“å…¥åªæœ‰è¿”å›å€¼</p>
</li>
<li><blockquote>
<blockquote>
<p>å‡½æ•°å¼æ¥å£éƒ½å¯ä»¥ç”¨lambdaæ¥å£ç®€åŒ–</p>
</blockquote>
</blockquote>
</li>
<li><blockquote>
<blockquote>
<p>æ³›å‹,æšä¸¾,åå°„,ä¼ ç»Ÿç¨‹åºå‘˜å¸¸ç”¨</p>
</blockquote>
</blockquote>
</li>
</ul>
<h3 id="Streamæµå¼è®¡ç®—"><a href="#Streamæµå¼è®¡ç®—" class="headerlink" title="Streamæµå¼è®¡ç®—"></a>Streamæµå¼è®¡ç®—</h3><p><code>æ“ä½œ:å­˜å‚¨+è®¡ç®—</code></p>
<ul>
<li><p>å­˜å‚¨:é›†åˆ,mysql</p>
</li>
<li><p>è®¡ç®—éƒ½åº”è¯¥äº¤ç»™æµæ¥æ“ä½œ</p>
</li>
</ul>
<p><img src="https://sheepnote.oss-cn-shenzhen.aliyuncs.com/20201006/20210323160253.png" alt="image-20210323160253580" loading="lazy"></p>
<p><img src="https://sheepnote.oss-cn-shenzhen.aliyuncs.com/20201006/20210323160508.png" alt="image-20210323160507757" loading="lazy">10</p>
<ul>
<li>æ‰“å°ä¼ å…¥çš„å‚æ•°</li>
</ul>
<p><img src="https://sheepnote.oss-cn-shenzhen.aliyuncs.com/20201006/20210323160621.png" alt="image-20210323160621019" loading="lazy"></p>
<p><img src="https://sheepnote.oss-cn-shenzhen.aliyuncs.com/20201006/20210323160733.png" alt="image-20210323160733487" loading="lazy"></p>
<ul>
<li>æ¯ä¸ªæ–¹æ³•è¿”å›thiså°±èƒ½é“¾å¼</li>
</ul>
<h3 id="14-ForkJoin"><a href="#14-ForkJoin" class="headerlink" title="14:ForkJoin"></a>14:ForkJoin</h3><blockquote>
<blockquote>
<p>åˆ†æ”¯åˆå¹¶</p>
<ul>
<li>jdk1.7ä¹‹åå‡ºæ¥çš„</li>
<li>å¹¶è¡Œæ‰§è¡Œä»»åŠ¡,æé«˜æ•ˆç‡</li>
<li>è·³è¿‡</li>
</ul>
</blockquote>
</blockquote>
<h3 id="15-å¼‚æ­¥å›è°ƒ"><a href="#15-å¼‚æ­¥å›è°ƒ" class="headerlink" title="15:å¼‚æ­¥å›è°ƒ"></a>15:å¼‚æ­¥å›è°ƒ</h3><h3 id="16-JMM"><a href="#16-JMM" class="headerlink" title="16:JMM"></a>16:JMM</h3><h3 id="17-Volatileå¯è§æ€§åŠå…¶éåŸå­æ€§éªŒè¯"><a href="#17-Volatileå¯è§æ€§åŠå…¶éåŸå­æ€§éªŒè¯" class="headerlink" title="17:Volatileå¯è§æ€§åŠå…¶éåŸå­æ€§éªŒè¯"></a>17:Volatileå¯è§æ€§åŠå…¶éåŸå­æ€§éªŒè¯</h3><ul>
<li><p>ä¿è¯å¯è§æ€§</p>
</li>
<li><p>ä¸ä¿è¯åŸå­æ€§</p>
</li>
<li><p>ACIDä¸­å°±æœ‰åŸå­æ€§:ä¸å¯åˆ†å‰²</p>
</li>
<li><p>å¹»è¯»,è„è¯»</p>
<p><code>atomicåŒ…</code></p>
<h4 id="ä½¿ç”¨åŸå­ç±»è§£å†³åŸå­æ€§é—®é¢˜"><a href="#ä½¿ç”¨åŸå­ç±»è§£å†³åŸå­æ€§é—®é¢˜" class="headerlink" title="ä½¿ç”¨åŸå­ç±»è§£å†³åŸå­æ€§é—®é¢˜"></a>ä½¿ç”¨åŸå­ç±»è§£å†³åŸå­æ€§é—®é¢˜</h4></li>
</ul>
<h3 id="æŒ‡ä»¤é‡æ’"><a href="#æŒ‡ä»¤é‡æ’" class="headerlink" title="æŒ‡ä»¤é‡æ’"></a>æŒ‡ä»¤é‡æ’</h3><blockquote>
<p>æºä»£ç -&gt;ç¼–è¯‘å™¨ä¼˜åŒ–çš„é‡æ’,æŒ‡ä»¤å¹¶è¡Œä¹Ÿå¯èƒ½ä¼šé‡æ’-&gt;å†…å­˜ç³»ç»Ÿä¹Ÿä¼šé‡æ’â€“&gt;æ‰§è¡Œ</p>
<ul>
<li>å¤„ç†å™¨è¿›è¡ŒæŒ‡ä»¤é‡æ’çš„æ—¶å€™,ä¼šè€ƒè™‘æ•°æ®çš„ä¾èµ–æ€§</li>
<li></li>
</ul>
</blockquote>
<p>volatileé¿å…æŒ‡ä»¤é‡æ’</p>
<ul>
<li>å†…å­˜å±éšœ.cpuæŒ‡ä»¤,ä½œç”¨:</li>
<li>1:ä¿è¯ç‰¹å®šçš„æ“ä½œçš„æ‰§è¡Œé¡ºåº</li>
<li>å¯ä»¥ä¿è¯æŸäº›å˜é‡çš„å†…å­˜å¯è§æ€§</li>
</ul>
<h3 id="DCLæ‡’æ±‰å¼å°±ä½¿ç”¨äº†volatile"><a href="#DCLæ‡’æ±‰å¼å°±ä½¿ç”¨äº†volatile" class="headerlink" title="DCLæ‡’æ±‰å¼å°±ä½¿ç”¨äº†volatile"></a>DCLæ‡’æ±‰å¼å°±ä½¿ç”¨äº†volatile</h3><ul>
<li>é¥¿æ±‰å¼å•ä¾‹â€“æ„é€ å™¨ç§æœ‰</li>
</ul>
<p><img src="https://sheepnote.oss-cn-shenzhen.aliyuncs.com/20201006/20210324210652.png" alt="image-20210324210646067" loading="lazy"></p>
<ul>
<li>å¯èƒ½æµªè´¹å†…å­˜</li>
</ul>
<p>æ‡’æ±‰å¼</p>
<ul>
<li>å…ˆæ„é€ å™¨ç§æœ‰</li>
<li>ä¸ä¸ºç©ºåˆ™å†ä¸ºåˆ›å»º</li>
<li><img src="https://sheepnote.oss-cn-shenzhen.aliyuncs.com/20201006/20210324211031.png" alt="image-20210324211031110" loading="lazy"></li>
<li>å¤šçº¿ç¨‹æƒ…å†µä¸‹å¤±è´¥</li>
<li>å¦‚æœ==null,å…ˆä¸Šé”</li>
<li>åŒé‡æ£€æµ‹é”æ‡’æ±‰å¼</li>
<li>lazayman=new lazyman()ä¸æ˜¯åŸå­æ€§æ“ä½œ</li>
<li><ul>
<li>åˆ†é…å†…å­˜ç©ºé—´</li>
<li>æ‰§è¡Œæ„é€ æ–¹æ³•,åˆå§‹åŒ–å¯¹è±¡</li>
<li>æŠŠå¯¹è±¡æŒ‡å‘ç©ºé—´</li>
<li>å¦‚æœèµ°æˆ132</li>
<li>å…¶ä»–çº¿ç¨‹å‘ç°ç©ºé—´é‡Œæœ‰å¯¹è±¡,ä½†æ˜¯å®é™…ä¸Šæœªåˆå§‹åŒ–,è¿”å›äº†æœªåˆå§‹åŒ–çš„å¯¹è±¡</li>
<li><img src="https://sheepnote.oss-cn-shenzhen.aliyuncs.com/20201006/20210324211618.png" alt="image-20210324211618757" loading="lazy"></li>
</ul>
</li>
<li><img src="https://sheepnote.oss-cn-shenzhen.aliyuncs.com/20201006/20210324211142.png" alt="image-20210324211142656" loading="lazy"></li>
<li>åˆ©ç”¨åå°„ç ´åå•ä¾‹æ¨¡å¼</li>
<li><img src="https://sheepnote.oss-cn-shenzhen.aliyuncs.com/20201006/20210324211902.png" alt="image-20210324211902466" loading="lazy"></li>
<li>é˜²æ­¢</li>
<li>ç»™æ„é€ å™¨åŠ ä¸ªé”,å¦‚æœå·²ç»æœ‰å¯¹è±¡,</li>
<li><img src="https://sheepnote.oss-cn-shenzhen.aliyuncs.com/20201006/20210324211944.png" alt="image-20210324211944040" loading="lazy"></li>
</ul>
<h3 id="æšä¸¾"><a href="#æšä¸¾" class="headerlink" title="æšä¸¾:"></a>æšä¸¾:</h3><blockquote>
<p>jdk1.5æ–°å¢</p>
<p>æœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªclassç±»</p>
</blockquote>
<h3 id="CAS"><a href="#CAS" class="headerlink" title="CAS"></a>CAS</h3><blockquote>
<p>compareAndSwap:æ¯”è¾ƒå¹¶äº¤æ¢</p>
</blockquote>
<blockquote>
<p> å¦‚æœæœŸæœ›çš„å€¼è¾¾åˆ°äº†,åˆ™æ›´æ–°,å¦åˆ™ä¸æ›´æ–°</p>
</blockquote>
<p><img src="https://sheepnote.oss-cn-shenzhen.aliyuncs.com/20201006/20210324213529.png" alt="image-20210324213529144" loading="lazy"></p>
<p>javaæ— æ³•æ“ä½œå†…å­˜</p>
<p>javaå¯ä»¥è°ƒç”¨C++native</p>
<p>C++å¯ä»¥æ“ä½œå†…å­˜</p>
<p>javaçš„åé—¨,å¯ä»¥é€šè¿‡è¿™ä¸ªæ“ä½œå†…å­˜</p>
<p><img src="https://sheepnote.oss-cn-shenzhen.aliyuncs.com/20201006/20210324213831.png" alt="image-20210324213831438" loading="lazy"></p>
<p>offset:å†…å­˜åç§»</p>
<p><img src="https://sheepnote.oss-cn-shenzhen.aliyuncs.com/20201006/20210324214022.png" alt="image-20210324214022006" loading="lazy"></p>
<ul>
<li>å†…å­˜æ“ä½œ,æ•ˆç‡å¾ˆé«˜</li>
<li>è‡ªæ—‹é”,ä¸åœæ—‹è½¬ç›´åˆ°æˆåŠŸä¸ºæ­¢</li>
<li><img src="https://sheepnote.oss-cn-shenzhen.aliyuncs.com/20201006/20210324214145.png" alt="image-20210324214144352" loading="lazy"></li>
<li>CAS:ABAé—®é¢˜(ç‹¸çŒ«æ¢å¤ªå­)</li>
<li><ul>
<li>æ¯”è¾ƒå½“å‰å·¥ä½œå†…å­˜ä¸­çš„å€¼å’Œä¸»å†…å­˜çš„å€¼,å¦‚æœä¹‹æ­Œå€¼æ˜¯æœŸæœ›çš„,é‚£ä¹ˆæ‰§è¡Œæ“ä½œ,å¦‚æœä¸æ˜¯å°±ä¸€ç›´å¾ªç¯</li>
<li>å¥½å¤„:è‡ªå¸¦åŸå­æ€§</li>
<li>ç¼ºç‚¹ :</li>
<li>å¾ªç¯ä¼šè€—æ—¶</li>
<li>ä¸€æ¬¡æ€§åªèƒ½ä¿è¯ä¸€ä¸ªå…±äº«å˜é‡çš„åŸå­æ€§</li>
</ul>
</li>
<li>UnSafeç±»</li>
<li></li>
</ul>
<h3 id="ABAé—®é¢˜"><a href="#ABAé—®é¢˜" class="headerlink" title="ABAé—®é¢˜"></a>ABAé—®é¢˜</h3><p>CASæ—¶æ£ä¹±çº¿ç¨‹æ”¹è¿‡åˆæ”¹å›å»äº†</p>
<ul>
<li>ä¹è§‚é”,æ‚²è§‚é”</li>
</ul>
<h3 id="åŸå­å¼•ç”¨"><a href="#åŸå­å¼•ç”¨" class="headerlink" title="åŸå­å¼•ç”¨"></a>åŸå­å¼•ç”¨</h3><p>TimeUnit.secondes.sleep()æ¥å»¶æ—¶</p>
<p>åƒSQlæ’å…¥åç‰ˆæœ¬å·æå‡1</p>
<p><img src="C:/Users/Lenovo/AppData/Roaming/Typora/typora-user-images/image-20210324220212708.png" alt="image-20210324220212708" loading="lazy"></p>
<p>åŸå­ç±»å‹æ”¹ä¸ºåŸå­å¼•ç”¨,åŠ ä¸Šäº†æ—¶é—´æˆ³</p>
<p>ä¹è§‚é”æœ‰CASå’Œç‰ˆæœ¬å·ä¸¤ç§è§£å†³æ–¹å¼</p>
<p><img src="C:/Users/Lenovo/AppData/Roaming/Typora/typora-user-images/image-20210324220422410.png" alt="image-20210324220422410" loading="lazy"></p>
<h3 id="æ­¤å¤„éœ€è¦æ•²ä»£ç -è¿˜æœ‰å•ä¾‹æ¨¡å¼è¿™äº›"><a href="#æ­¤å¤„éœ€è¦æ•²ä»£ç -è¿˜æœ‰å•ä¾‹æ¨¡å¼è¿™äº›" class="headerlink" title="æ­¤å¤„éœ€è¦æ•²ä»£ç ,è¿˜æœ‰å•ä¾‹æ¨¡å¼è¿™äº›"></a>æ­¤å¤„éœ€è¦æ•²ä»£ç ,è¿˜æœ‰å•ä¾‹æ¨¡å¼è¿™äº›</h3><h3 id="21-å¯¹å„ç§é”çš„ç†è§£"><a href="#21-å¯¹å„ç§é”çš„ç†è§£" class="headerlink" title="21:å¯¹å„ç§é”çš„ç†è§£"></a>21:å¯¹å„ç§é”çš„ç†è§£</h3><h4 id="å…¬å¹³é”-éå…¬å¹³é”"><a href="#å…¬å¹³é”-éå…¬å¹³é”" class="headerlink" title="å…¬å¹³é”,éå…¬å¹³é”"></a>å…¬å¹³é”,éå…¬å¹³é”</h4><ul>
<li>å…¬å¹³é”æš–æ’é˜Ÿ,å…¬å¹³é”å¯ä»¥æ’é˜Ÿ</li>
<li>éå…¬å¹³é”,å¯ä»¥æ’é˜Ÿ(é»˜è®¤éƒ½æ˜¯éå…¬å¹³)</li>
<li>3sçš„ä¸ç­‰å¾…å¾ˆå¤šç§’çš„</li>
<li>Lock =new RestrantLock()</li>
<li>å‚æ•°ä¼ å…¥Trueåˆ™ä¸ºå…¬å¹³é”</li>
</ul>
<h4 id="å¯é‡å…¥é”-é€’å½’é”"><a href="#å¯é‡å…¥é”-é€’å½’é”" class="headerlink" title="å¯é‡å…¥é”/é€’å½’é”"></a>å¯é‡å…¥é”/é€’å½’é”</h4><p>Re en trant:Reentrant<br>001</p>
<p><img src="C:/Users/Lenovo/AppData/Roaming/Typora/typora-user-images/image-20210324220914187.png" alt="image-20210324220914187" loading="lazy"></p>
</div><div id="reward-container"><span class="hty-icon-button button-glow" id="reward-button" title="æ‰“èµ" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === &quot;none&quot;) ? &quot;block&quot; : &quot;none&quot;;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-hand-coin-line"></use></svg></span><div id="reward-comment">I'm so cute. Please give me money.</div><div id="qr" style="display:none;"><div style="display:inline-block"><a href="/images/money.jpg"><img loading="lazy" src="/images/money.jpg" alt="å¾®ä¿¡æ”¯ä»˜" title="å¾®ä¿¡æ”¯ä»˜"></a><div><span style="color:#2DC100"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-wechat-pay-line"></use></svg></span></div></div></div></div></section></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/2022/02/11/%E6%8E%A5%E5%8F%A3%E5%92%8C%E6%8A%BD%E8%B1%A1%E7%B1%BB/" rel="prev" title="æ¥å£å’ŒæŠ½è±¡ç±»åŒºåˆ«"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-left-s-line"></use></svg><span class="post-nav-text">æ¥å£å’ŒæŠ½è±¡ç±»åŒºåˆ«</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/2021/03/19/%E6%9F%A5%E5%B1%B1%E6%AD%A3/" rel="next" title="æŸ¥å±±æ­£å¾®ä¿¡å°ç¨‹åº"><span class="post-nav-text">æŸ¥å±±æ­£å¾®ä¿¡å°ç¨‹åº</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-right-s-line"></use></svg></a></div></div></div><div id="comment"><div class="comment-tooltip text-center"><span>æ¬¢è¿æ¥è¸©ä¸€è¸©</span><br><a class="hty-button hty-button--raised" id="github-issues" target="_blank" rel="noopener" href="https://github.com/YunYouJun/yunyoujun.github.io/issues?q=is:issue+JUCå¹¶å‘å­¦ä¹ ç¬”è®°">GitHub Issues</a></div><div id="valine-container"></div><script src="https://cdn.jsdelivr.net/npm/valine@latest/dist/Valine.min.js"></script><script>function initValine() {
  const valineConfig = {"enable":true,"appId":"K8sNkb431hIYsYIJt5cY5ej8-gzGzoHsz","appKey":"lDlaLdG4bnwWtiHoTg9hxfR8","placeholder":"æœ•æ›°","avatar":null,"pageSize":10,"visitor":false,"highlight":true,"recordIP":false,"enableQQ":true,"meta":["nick","mail","link"],"el":"#valine-container","lang":"zh-cn"}
  valineConfig.path = window.location.pathname
  new Valine(valineConfig)
}
setTimeout(initValine, 800)</script></div></main><footer class="sidebar-translate" id="footer"><div class="copyright"><span>&copy; 2019 â€“ 2021 </span><span class="with-love" id="animate"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-cloud-line"></use></svg></span><span class="author"> åŒ…å­å›</span></div><div class="powered"><span>ç”± <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> é©±åŠ¨ v5.2.0</span><span class="footer-separator">|</span><span>ä¸»é¢˜ - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.2.0</span></div><div class="live_time"><span>æœ¬åšå®¢å·²èŒèŒå“’åœ°è¿è¡Œ</span><span id="display_live_time"></span><span class="moe-text">(â—'â—¡'â—)</span><script>function blog_live_time() {
  window.setTimeout(blog_live_time, 1000);
  const start = new Date('2020-10-12T00:00:00');
  const now = new Date();
  const timeDiff = (now.getTime() - start.getTime());
  const msPerMinute = 60 * 1000;
  const msPerHour = 60 * msPerMinute;
  const msPerDay = 24 * msPerHour;
  const passDay = Math.floor(timeDiff / msPerDay);
  const passHour = Math.floor((timeDiff % msPerDay) / 60 / 60 / 1000);
  const passMinute = Math.floor((timeDiff % msPerHour) / 60 / 1000);
  const passSecond = Math.floor((timeDiff % msPerMinute) / 1000);
  display_live_time.innerHTML = " " + passDay + " å¤© " + passHour + " å°æ—¶ " + passMinute + " åˆ† " + passSecond + " ç§’";
}
blog_live_time();
</script></div></footer><a class="hty-icon-button" id="goUp" aria-label="back-to-top" href="#"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-up-s-line"></use></svg><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a><a class="popup-trigger hty-icon-button icon-search" id="search" target="_blank" rel="noopener" href="https://www.google.com/search?q=site:darksheep.xyz" title="æœç´¢"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-search-line"></use></svg></span></a></div><script defer src="/js/utils.js"></script><script defer src="/js/hexo-theme-yun.js"></script></body></html>